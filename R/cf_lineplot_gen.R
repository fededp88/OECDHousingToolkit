cf_lineplot_gen <- function(data_source,xvar,yvar,valuevar,title=NULL,
                            subtitle=NULL,Xlabel=NULL,Ylabel=NULL,country) {


  data_source2 <- data_source %>% filter(ISO3_code==country) %>%
    mutate(ISO3_code=countrycode::countrycode(country,origin="iso3c",destination="country.name"))
  data_source3 <- data_source %>% group_by(period) %>% summarize(OECDmean=mean(get(valuevar),na.rm=T))

  ggplot(data=data_source) +
    geom_line(aes(x=get(xvar), y=get(valuevar), group=get(yvar)),alpha=0.05) +
    labs(title = title,
         subtitle = subtitle,
         x = Xlabel,
         y = Ylabel) +
    theme_minimal() +   #set the background of the plot as white
    theme(panel.grid.minor =  element_blank(),
          legend.position ="right",
          legend.title=element_blank(),
          legend.text = element_text(size=10),
          legend.justification="center",
          legend.margin=margin(0,0,0,0),
          legend.box.margin=margin(0,0,0,0),
          #aspect.ratio=2,
          #legend.margin = margin(0.2, 0.2, 0.2, 0.2, "cm"),
          legend.key.size = unit(0.5,"line"),
          axis.title.x = element_blank(),
          axis.title.y = element_blank(),
          axis.text.x = element_text(size=8),
          axis.text.y = element_text(size=8),
          plot.title=element_blank(),
          plot.subtitle =element_blank()) +
    #geom_line(data=data_source2,aes(x=get(xvar), y=get(valuevar),colour=get(yvar))) +
    #geom_line(data=data_source3,aes(x=get(xvar), y=OECDmean),colour="blue",alpha=0.5)
    geom_line(data=data_source2, mapping= aes(x=get(xvar), y=get(valuevar), colour=country)) +
    geom_line(data=data_source3, mapping= aes(x=get(xvar), y=OECDmean, colour="OECD")) +
    scale_colour_manual( "",
                         breaks = c(country, "OECD"),
                         values = c("red", "blue"))
}
